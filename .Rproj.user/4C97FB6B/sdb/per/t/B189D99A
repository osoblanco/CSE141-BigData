{
    "contents" : "#####Homework 1#######\r\n#1. Code line should be written under its question\r\n#2. Whenever you need to give interpretation \r\n#(mean, stdev, result of the hypothesis test) write the interpretations\r\n#under the question\r\n#The homework is worth of 35 points\r\n#submit your R code to moodle\r\n\r\n#1. Read the dataset bank-full.csv\r\nbank_full<-read.csv(\"bank-full.csv\")\r\n\r\n##2. How many variables do you have? How many cases do you have? (1 point)\r\n\r\nnrow(bank_full) #number of cases=45211\r\nncol(bank_full) # number of variables =17\r\n\r\n##3. make a random sample of 20,000 cases, for the further analysis use this dataset (1 point)\r\n\r\nset.seed(0007)\r\nbank_samp<-bank_full[sample(nrow(bank_full),20000),]\r\n\r\n#4. Give summary statistics for the variable Age (1 point)\r\nsummary(bank_samp$age)\r\nsd(bank_samp$age) #standard Deviation\r\n\r\n##Minimum - 18.00\r\n##Maximum - 94.00\r\n##Median - 39.00\r\n## stdev  - 10.56646\r\n\r\n##5. The variable education shows the highest education level that a customer has \r\n##(categorical variable). The variable balance is the average yearly balance of \r\n##the customer. Find the average balance for each category for the education. (2 points)\r\naggregate(bank_samp$balance, by=list(bank_samp$education), FUN=\"mean\", na.rm=TRUE)\r\n\r\n#Fill the values\r\n#Primary - 1232.377\r\n#secondary - 1146.512\r\n#tertiary - 1702.478\r\n#Unknown - 1672.252\r\n\r\n##6. Find the sdandard deviation of the variable balance for each category \r\n## of education (3 points)\r\n## hint - (look at the argument FUN)\r\naggregate(bank_samp$balance, by=list(bank_samp$education), FUN=\"sd\", na.rm=TRUE)\r\n\r\n#Primary - 2679.933\r\n#Secondary - 2608.905\r\n#tertirary - 3644.386\r\n#unknown - 3217.068\r\n\r\n##7.  The variable marital shows the marital status of the respondent\r\n#what is the most frequent category for this variable? (2 points)\r\ntable(bank_samp$marital)\r\n\r\n## The most frequent category is __MARRIED____ with the frequency of ___12070__\r\n\r\n##8. Create frequency (contingency) table for the variables marital and loan. (2 points)\r\ntable(bank_samp$marital, bank_samp$loan)\r\n\r\n##9.  What percentage of maried customers have a loan? (3 points)\r\nprop.table(table(bank_samp$marital,bank_samp$loan),1)\r\n## % of married that have a loan = 17.08368%\r\n\r\n##10. From those who have a loan, what percentage are married people? (3 points)\r\nprop.table(table(bank_samp$marital,bank_samp$loan),2)\r\n## % of those who have loan, married are  = 65.28117%\r\n\r\n##11.  Create a bar chart for the variable marital. Be sure that it is a \"good graph\".\r\n## The bars in the chart should be colored in blue. Hint: use argument \"col\". (2 points)\r\nbarplot(table(bank_samp$marital), xlab=\"Marital Status\", ylab=\"Frequences\", main=\"Marital distribution\", col=\"blue\", border=NA)\r\n\r\n##11. Create histogram for the variable balance. Use both qplot and hist functions.\r\n##Which chart looks better? can you make the histogram more readable? \r\n##(hint: play with xlim, ylim and bin lenghts). Be sure to make  a good graph. (4 points)\r\n\r\nhist(bank_samp$balance,xlab = \"Balance\",main=\"Balance Distribution\",freq = FALSE)\r\nlibrary(\"ggplot2\")\r\nqplot(balance,data=bank_samp,geom=\"histogram\",binwidth=0.2,xlim = c(0,200),ylim = c(0,100))\r\nqplot(balance,data=bank_samp,geom=\"histogram\",binwidth=3,xlim = c(0,2000),ylim = c(0,100))\r\n\r\n##Interpret the histogram in your words (hint: is it skewed?)\r\n#The Graph is obviously skewed to right.The Greater The Balance the smaller the Count a.k.a Frequency.\r\n# Shat balansov Mard gnalov aveli qich ka\r\n\r\n##12. You need to explore a little capacities of qplot. \r\n##Create one graph on your own, that gives an interesting insight about the \r\n##variables (4 points)\r\n\r\nqplot(education,balance,data=bank_samp,geom=\"jitter\",stat=\"identity\")\r\nqplot(education,age,data=bank_samp,geom=\"jitter\",stat=\"identity\")\r\n\r\n\r\n####Inferential Statistics#####\r\n## 13. Is there a relationship between default and balance? (2 points)\r\nchisq.test(table(bank_samp$default, bank_samp$balance))\r\n\r\n##Interpret the results of the hypothesis testing\r\n#The variables Default and Balance are obviously related due to the fact that p we got is \r\n# 2.2*10^(-16) meaning that it is sufficiently small to reject the null hypothesis.\r\n\r\n##14. Have a look at the variables loan and housing. Are they independent? (2 points)\r\nchisq.test(table(bank_samp$loan, bank_samp$housing))\r\n\r\n\r\n##Interpret the results\r\n#The variables Loan and Housing are also  related due to the fact that p we got is sufficently minute \r\n# 2.2*10^(-16) meaning that we can reject the null hypothesis.\r\n\r\n##15. Look at the correlation coefficients of variable campaign and all other \r\n##numerical variables.  \r\ncor(bank_samp[,c(\"campaign\",\"age\", \"balance\", \"day\", \"duration\", \"pdays\", \"previous\")])\r\n##What are two variables that have the strongest correlation with Age. (3 points)\r\n\r\n# The two strongest correlations found to variable Age are the Pdays and Balance\r\n",
    "created" : 1443033204686.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3426684371",
    "id" : "B189D99A",
    "lastKnownWriteTime" : 1443046065,
    "path" : "~/Documents/AUA courses/Year 2/intro to Data/R/Homework_1/Homework1_Erik_Arakelyan.R",
    "project_path" : "Homework1_Erik_Arakelyan.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : true,
    "type" : "r_source"
}